<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.3 on Wed Sep 14 19:26:31 2011 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>test_hiihat_preprocess_ut__define.pro (HiiHAT)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="test_hiihat_preprocess_ut__define.pro (HiiHAT)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><a id="test_hiihat_preprocess_ut__define:source"></a>pro test_hiihat_preprocess_ut__define
<span class="comments">;+</span>
<span class="comments">; Unit test entry point definition for preprocessing functions.</span>
<span class="comments">; Initializes MGTestCase structure for MGUnit unit test. </span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   testing</span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Jan 7, 2011 (BDB): Initial implementation</span>
<span class="comments">;  </span>
<span class="comments">; :Examples:</span>
<span class="comments">;   This unit test can be run with the following command:</span>
<span class="comments">;</span>
<span class="comments">;   mgunit, 'test_hiihat_preprocess_ut'</span>
<span class="comments">;</span>
<span class="comments">; :Author: Brian D. Bue</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;  Copyright 2011, by the California Institute of Technology. ALL RIGHTS</span>
<span class="comments">;  RESERVED. United States Government Sponsorship acknowledged. Any commercial</span>
<span class="comments">;  use must be negotiated with the Office of Technology Transfer at the</span>
<span class="comments">;  California Institute of Technology.</span>
<span class="comments">; </span>
<span class="comments">;  This software may be subject to U.S. export control laws and regulations.  By</span>
<span class="comments">;  accepting this document, the user agrees to comply with all applicable U.S.</span>
<span class="comments">;  export laws and regulations.  User has the responsibility to obtain export</span>
<span class="comments">;  licenses, or other export authority as may be required before exporting such</span>
<span class="comments">;  information to foreign countries or providing access to foreign persons.</span>
<span class="comments">;-  compile_opt strictarr</span>
  
  define = { test_hiihat_preprocess_ut, $
             tmpdir:'', seed:0, verbose:0, debug:0, $
             inherits MGTestCase } 
end

<a id="test_hiihat_preprocess_ut::test_0_init:source"></a>function test_hiihat_preprocess_ut::test_0_init
<span class="comments">;+</span>
<span class="comments">; Initialization test and parameters for preprocessing functions.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   testing</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;   Initializes parameters used by the preprocessing unit tests and</span>
<span class="comments">;   verifies that the HiiHAT directory is</span>
<span class="comments">;   accessible. This test is run before any other preprocessing</span>
<span class="comments">;   unit tests are executed. </span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Jan 7, 2011 (BDB): Initial implementation</span>
<span class="comments">;  </span>
<span class="comments">; :Author: Brian D. Bue</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;  Copyright 2011, by the California Institute of Technology. ALL RIGHTS</span>
<span class="comments">;  RESERVED. United States Government Sponsorship acknowledged. Any commercial</span>
<span class="comments">;  use must be negotiated with the Office of Technology Transfer at the</span>
<span class="comments">;  California Institute of Technology.</span>
<span class="comments">; </span>
<span class="comments">;  This software may be subject to U.S. export control laws and regulations.  By</span>
<span class="comments">;  accepting this document, the user agrees to comply with all applicable U.S.</span>
<span class="comments">;  export laws and regulations.  User has the responsibility to obtain export</span>
<span class="comments">;  licenses, or other export authority as may be required before exporting such</span>
<span class="comments">;  information to foreign countries or providing access to foreign persons.</span>
<span class="comments">;-</span>
  hh_path = hiihat_get_config_parm('hiihat_path')
  assert, file_test(hh_path), "HiiHAT directory missing"
  self.verbose = 0
  self.debug = 0
  self.tmpdir = getenv("IDL_TMPDIR")
  self.seed = 1
  return, 1
end

<a id="test_hiihat_preprocess_ut::test_median_filter:source"></a>function test_hiihat_preprocess_ut::test_median_filter
<span class="comments">;+</span>
<span class="comments">; Tests median filtering function on a simple image.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   testing</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;   Tests the median filtering function on a 10x10x4 image where all</span>
<span class="comments">;   of the elements of each band correspond to their (zero-indexed)</span>
<span class="comments">;   band number. The median filtered result should consist of only the</span>
<span class="comments">;   3 values [1,2,3].</span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Jan 7, 2011 (BDB): Initial implementation</span>
<span class="comments">;  </span>
<span class="comments">; :Author: Brian D. Bue</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;  Copyright 2011, by the California Institute of Technology. ALL RIGHTS</span>
<span class="comments">;  RESERVED. United States Government Sponsorship acknowledged. Any commercial</span>
<span class="comments">;  use must be negotiated with the Office of Technology Transfer at the</span>
<span class="comments">;  California Institute of Technology.</span>
<span class="comments">; </span>
<span class="comments">;  This software may be subject to U.S. export control laws and regulations.  By</span>
<span class="comments">;  accepting this document, the user agrees to comply with all applicable U.S.</span>
<span class="comments">;  export laws and regulations.  User has the responsibility to obtain export</span>
<span class="comments">;  licenses, or other export authority as may be required before exporting such</span>
<span class="comments">;  information to foreign countries or providing access to foreign persons.</span>
<span class="comments">;-</span>
  img = fltarr(10,10,4)
  img[*,*,1] += 1
  img[*,*,2] += 2
  img[*,*,3] += 3
  hiihat_median_filter_image, img, 1
  uniq_res = img[uniq(img,sort(img))] <span class="comments">;; should be 1,2,3</span>
  assert, n_elements(uniq_res) eq 3, 'Median filter produced unexpected output'
  assert, total(uniq_res eq [1,2,3]) eq 3, 'Median filter produced unexpected output'
  return, 1
end

<a id="test_hiihat_preprocess_ut::test_normalizaton:source"></a>function test_hiihat_preprocess_ut::test_normalizaton
<span class="comments">;+</span>
<span class="comments">; Tests normalization function on a simple image using several norm types</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   testing</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;   Tests the normalization function on a 20x20x10 unitary image using</span>
<span class="comments">;   the L1, L2, and Linf norms. Fails if any of the norm values are</span>
<span class="comments">;   non-unique or do not match their analytical value.</span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Jan 7, 2011 (BDB): Initial implementation</span>
<span class="comments">;  </span>
<span class="comments">; :Author: Brian D. Bue</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;  Copyright 2011, by the California Institute of Technology. ALL RIGHTS</span>
<span class="comments">;  RESERVED. United States Government Sponsorship acknowledged. Any commercial</span>
<span class="comments">;  use must be negotiated with the Office of Technology Transfer at the</span>
<span class="comments">;  California Institute of Technology.</span>
<span class="comments">; </span>
<span class="comments">;  This software may be subject to U.S. export control laws and regulations.  By</span>
<span class="comments">;  accepting this document, the user agrees to comply with all applicable U.S.</span>
<span class="comments">;  export laws and regulations.  User has the responsibility to obtain export</span>
<span class="comments">;  licenses, or other export authority as may be required before exporting such</span>
<span class="comments">;  information to foreign countries or providing access to foreign persons.</span>
<span class="comments">;-</span>
  img = fltarr(20,20,10)+1
  hiihat_normalize_image, img,'Area (L 1)'
  uniq_res = img[uniq(img,sort(img))]
  assert, n_elements(uniq_res) eq 1, "Non-unique output for unit image"
  assert, uniq_res[0] eq 0.1, "Incorrect L1 norm output"

  img = fltarr(20,20,10)+1
  hiihat_normalize_image, img,'Euclidean (L 2)'
  uniq_res = img[uniq(img,sort(img))]
  assert, n_elements(uniq_res) eq 1, "Non-unique output for unit image"
  assert, abs(uniq_res[0]-0.316228) lt 0.000001, "Incorrect L2 norm output"

  img = fltarr(20,20,10)+1
  hiihat_normalize_image, img,'Peak (L inf)'
  uniq_res = img[uniq(img,sort(img))]
  assert, n_elements(uniq_res) eq 1, "Non-unique output for unit image"
  assert, uniq_res[0] eq 1, "Incorrect L inf norm output"

  return, 1
end

<a id="test_hiihat_preprocess_ut::test_meandiv:source"></a>function test_hiihat_preprocess_ut::test_meandiv
<span class="comments">;+</span>
<span class="comments">; Tests mean division function on a simple image.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   testing</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;   Tests the mean diviscion function on a 10x10x10 unitary</span>
<span class="comments">;   image. Fails if the Mean and MeanColumn divisions do not produce</span>
<span class="comments">;   the same output. </span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Jan 7, 2011 (BDB): Initial implementation</span>
<span class="comments">;  </span>
<span class="comments">; :Author: Brian D. Bue</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;  Copyright 2011, by the California Institute of Technology. ALL RIGHTS</span>
<span class="comments">;  RESERVED. United States Government Sponsorship acknowledged. Any commercial</span>
<span class="comments">;  use must be negotiated with the Office of Technology Transfer at the</span>
<span class="comments">;  California Institute of Technology.</span>
<span class="comments">; </span>
<span class="comments">;  This software may be subject to U.S. export control laws and regulations.  By</span>
<span class="comments">;  accepting this document, the user agrees to comply with all applicable U.S.</span>
<span class="comments">;  export laws and regulations.  User has the responsibility to obtain export</span>
<span class="comments">;  licenses, or other export authority as may be required before exporting such</span>
<span class="comments">;  information to foreign countries or providing access to foreign persons.</span>
<span class="comments">;-</span>
  img1 = fltarr(10,10,10)+1
  img2 = img1

  hiihat_divide_mean, img1, 'Spatial Mean'
  hiihat_divide_mean, img2, 'Spectral Mean'

  dialog='Spatial and Spectral Mean division produced unmatched output on uniform image'
  assert, total(img1-img2) eq 0, dialog
  return, 1
end

</code>
    </div>
  </body>
</html>